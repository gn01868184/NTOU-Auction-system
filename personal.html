<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <!-- Bootstrap 4 Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <!-- jQuery -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <title>海大拍賣系統</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light  bg-info">
        <a class="navbar-brand  text-light" href="./index.html"><span class="fas fa-tree"></span>&nbsp;海大拍賣</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <script>
            //這是登出function不要刪掉我QQ 喔抱歉！
            function eraseCookie() {
                document.cookie = `${document.cookie}` + "; expires=Thu, 01 Jan 1970 00:00:00 GMT";
                $('#ImageURL').attr('src', response[1].ImageURL)
                document.location.href = "./login.html";
            }
        </script>

        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
            <ul class="navbar-nav mr-auto mt-2 mt-lg-0">


                <li class="nav-item">
                    <a href="./search.html" class="btn btn-link text-light">
                        <span class="fas fa-search"></span>&nbsp;搜尋
                    </a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                    <li class="nav-item">
                        <a href="./sCart.html" class="btn btn-link text-light">
                            <span class="fas fa-shopping-cart"></span>&nbsp;購物車</a>
                    </li>
                    <li class="nav-item active">
                        <a href="./personal.html" class="btn btn-link text-light">
                            <span class="fas fa-user"></span>&nbsp;個人中心
                        </a>
                    </li>
                    <li class="nav-item">
                        <a onclick="eraseCookie()" class="btn btn-link text-light">
                            <span class="fas fa-sign-out-alt"></span>&nbsp;登出
                        </a>
                    </li>
                </ul>
            </form>


        </div>
    </nav>
    <h2>
        <p class="font-weight-bold text-info text-center mt-3"><span class="fas fa-user"></span>&nbsp;個人中心</p>
    </h2>
    <div class="card">
        <div class=" row no-gutters mx-3 my-2 ">
            <div class="col-3 mb-3  align-self-center">
                <div class="row no-gutters">
                    <span class="col-12 border rounded align-self-center" align="center">
                        <img src="http://member.businessweekly.com.tw/theme/v1/i/icon-member-m.gif" class="card-img-top col-10" style="height: 200px;width: 200px" id="ImageURL">
                    </span>
                </div>
            </div>

            <script>
                $(document).ready(function() {
                    $.ajax({
                        url: 'https://ntou-store-system.herokuapp.com/personalPage',
                        dataType: 'json',
                        type: "POST",
                        data: document.cookie.split("; ")[0],
                        //data: {     ID:6  },
                        error: function(xhr, ajaxOptions, thrownError) {
                            //alert(xhr.status + "\n" + thrownError);
                        },
                        success: function(response) {
                            if (response[1].ImageURL != null)
                                $('#ImageURL').attr('src', response[1].ImageURL)
                            //console.log(response[1].Name)
                            $('#Name').append(response[1].Name)
                            $('#NickName').append(response[1].NickName)
                            $('#Account').append(response[1].Account)
                            $('#PhoneNumber').append(response[1].PhoneNumber)
                            $('#Email').append(response[1].Email)
                            console.log(response[0][0].ProductName)
                            $('#ProductName').append(response[0][0].ProductName)
                        }
                    });
                });
            </script>



            <div class="card-body col-6 ml-3 align-self-center">
                <h4>
                    <div class="font-weight-bold " style="display:inline ;LINE-HEIGHT:40px" id="Name">姓名：</div><br>
                    <div class="font-weight-bold" style="display:inline ;LINE-HEIGHT:40px" id="NickName">小名：</div><br>
                    <div class="font-weight-bold" style="display:inline ;LINE-HEIGHT:40px" id="Account">帳號：</div><br>
                    <div class="font-weight-bold" style="display:inline ;LINE-HEIGHT:40px" id="PhoneNumber">手機：</div><br>
                    <div class="font-weight-bold" style="display:inline ;LINE-HEIGHT:40px" id="Email">信箱：</div><br>
                </h4>
            </div>
        </div>
    </div>
    <div class="row">
        <a class="btn btn-outline-success col-2 m-2 ml-4" href="./commodity.html">上架一般商品</a>
        <a class="btn btn-outline-success col-2 m-2" href="./bidding.html">上架競標商品</a>
    </div>

    <ul class="nav nav-tabs my-2 mx-1" id="myTab" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">架上商品</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="transaction-tab" data-toggle="tab" href="#transaction" role="tab" aria-controls="transaction" aria-selected="false">交易中商品</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="record-tab" data-toggle="tab" href="#record" role="tab" aria-controls="record" aria-selected="false">交易紀錄</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="browse-tab" data-toggle="tab" href="#browse" role="tab" aria-controls="browse" aria-selected="false">瀏覽紀錄</a>
        </li>
    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
            <div class="row mx-1">

                <div class="m-2 mb-3">

                    <!--編輯詳細資訊 editInfoModal-->
                    <div class="modal" id="editInfoModal" tabindex="-1" role="dialog" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">編輯詳細資訊</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form class="form-group" id="formEdit" action="https://ntou-store-system.herokuapp.com/personalPage/onSale/edit" method="POST">
                                        <!--<div class="card-body">
                                <label>詳細資訊:</label><br>
                                <div class="form-check form-check-inline col">
                                    <input type="text" class="form-control" name="Information" >                                   
                                </div>    
                            </div>-->
                                        <label>詳細資訊：</label>
                                        <div class="input-group">
                                            <!--<input name="ID" class="form-control" type="input" value="24" style="display:none">-->
                                            <textarea class="form-control" aria-label="With textarea" name="Information"></textarea>
                                        </div>
                                        <button class="btn btn-outline-success container mt-2" type="submit">確認</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <script>
                        $(function() {
                            $("#login").on('funcEditId', function(event) {
                                $.ajax({
                                    type: "POST",
                                    url: "{:url('admin/login/check')}",
                                    data: $("form").serialize(),
                                    dataType: 'json',
                                    success: function(data) {
                                        if (data.status == 1) {
                                            window.location.href = "{:url('index/index')}";
                                        } else {
                                            alert(data.message);
                                        }
                                    }
                                });
                            })
                        })
                    </script>


                    <div class="col-5">
                        <div class="row no-gutters" id="tableOnsale">



                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="transaction" role="tabpanel" aria-labelledby="transaction-tab">

            <div>
                <div class="m-3">



                    <div class="row no-gutters">
                        <div class="col-3" id="tableTrade">

                        </div>

                    </div>

                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="record" role="tabpanel" aria-labelledby="record-tab">

            <div class="row mx-2">
                <div class="col-4 mb-3">

                    <script>
                        //交易紀錄
                        $(document).ready(function() {
                            //alert("交易紀錄ID"+document.cookie)
                            $.ajax({
                                url: 'https://ntou-store-system.herokuapp.com/personalPage/tradeRecord',
                                dataType: 'json',
                                type: "POST",
                                data: document.cookie,
                                //data: { ID:6 },
                                error: function(xhr, ajaxOptions, thrownError) {
                                    //alert(xhr.status + "\n" + thrownError);
                                },
                                success: function(response) {
                                    console.log(response.length)
                                    var s
                                    var vIden = ""
                                    var starSeller = ""
                                    var starProduct = ""
                                    for (var i = 0; i < response.length; i++) {
                                        vIden = response[i].Identity
                                        if (vIden == 0)
                                            vIden = "賣家"
                                        else
                                            vIden = "買家"
                                        
                                        s=response[i].BuyerEvSeller
                                        if (s == 1) 
                                            starSeller="★✩✩✩✩"
                                        else if(s == 2) 
                                            starSeller="★★✩✩✩"
                                        else if(s == 3) 
                                            starSeller="★★★✩✩"
                                        else if(s == 4) 
                                            starSeller="★★★★✩"
                                        else
                                            starSeller="★★★★★"
                                        
                                        s=response[i].BuyerEvProduct
                                        if (s == 1) 
                                            starProduct="★✩✩✩✩"
                                        else if(s == 2) 
                                            starProduct="★★✩✩✩"
                                        else if(s == 3) 
                                            starProduct="★★★✩✩"
                                        else if(s == 4) 
                                            starProduct="★★★★✩"
                                        else
                                            starProduct="★★★★★"
                                        
                                        $('#tradeCompleted').append('<table class="table table-bordered"><tbody>'

                                            +
                                            '<tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">身份：</div>' + vIden + '</td></tr>'

                                            +
                                            ' <tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">品名：</div>' + response[i].ProductName + '</td>' +
                                            '<td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易數量：</div>' + response[i].TradeAmount + '</td></tr>' +
                                            '<tr> <td> <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易總額：</div>' + response[i].TradePrice + '</td>' +
                                            '<td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">買家：</div>' + response[i].ProductName + '</td></tr>' +
                                            '<tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">賣家評級：</div>' + starSeller + '</td>'

                                            +
                                            '<td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">商品評級：</div>' + starProduct + '</td></tr>' +
                                            '<tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">商品評價：</div>' + response[i].BuyerEvText + '</td></tr></tbody></table>'
                                        )
                                    }
                                }
                            });
                        });
                    </script>
                    <div class=" no-gutters " id="tradeCompleted">

                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="browse" role="tabpanel" aria-labelledby="browse-tab">

            <div class="tab-content" id="myTabContent">
                <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                    <div class="row mx-1">
                        <div class="col-4 mb-3">


                            <script>
                                //瀏覽紀錄
                                $(document).ready(function() {
                                    $.ajax({
                                        url: 'https://ntou-store-system.herokuapp.com/personalPage/surfedRecord',
                                        dataType: 'json',
                                        type: "POST",
                                        data: document.cookie,
                                        //data: { ID:6 },
                                        error: function(xhr, ajaxOptions, thrownError) {
                                            alert(xhr.status + "\n瀏覽紀錄" + thrownError);
                                        },
                                        success: function(response) {
                                            //console.log(response.length)

                                            var v1Low1, v2Bid1, v3BidU1, v4BidD1 = ""


                                            for (var i = 0; i < response.length; i++) {
                                                v1Low1 = response[i].LowestPrice
                                                v2Bid1 = response[i].BiddingPrice
                                                v3BidU1 = response[i].BiddingUnitPrice
                                                v4BidD1 = response[i].BiddingDeadline

                                                if (v1Low1 == null)
                                                    v1Low1 = "X"
                                                if (v2Bid1 == null)
                                                    v2Bid1 = "X"
                                                if (v3BidU1 == null)
                                                    v3BidU1 = "X"
                                                if (v4BidD1 == null)
                                                    v4BidD1 = "X"
                                                $('#tableSurfedRecord').append('<table class="table table-bordered"><tbody><tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">品名：</div>' + response[i].ProductName + '</td>' + '<td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">直購價：</div>' + response[0].Price + '</td></tr>' +
                                                    '<tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">底價：</div>' + v1Low1 + '</td>' +
                                                    '<td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">競標價：</div>' + v2Bid1 + '</td></tr>' +
                                                    '<tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">競標單位價：</div>' + v3BidU1 + '</td>'

                                                    +
                                                    '<td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">結標時間：</div>' + v4BidD1 + '</td></tr>'

                                                    +
                                                    '<tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">瀏覽日期：</div>' + response[i].SurfingDate + '</td></tr></tbody></table>'
                                                )
                                            }
                                        }
                                    });
                                });
                            </script>

                            <div class="row no-gutters" id="tableSurfedRecord">

                            </div>
                        </div>
                    </div>
                </div>

                <!--fade-->
                <div class="tab-pane fade" id="transaction" role="tabpanel" aria-labelledby="transaction-tab">

                    <div class="row">
                        <div class="col-3 mb-3">
                            <div class="row no-gutters">
                                <span class="col-12 border rounded" align="center">
                                    <img src="https://upload.cc/i1/2019/12/11/6ylCR0.jpg" class="card-img-top col-10" alt="" style="max-height: 250px;width: auto">
                                </span>
                            </div>
                        </div>
                        <div class="col-5 mb-3">
                            <div class="row no-gutters">
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">品名：</div>皮卡丘娃娃
                                            </td>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易數量：</div>1
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易總額：</div>50
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">買家：</div>阿蔡
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <a class="btn btn-outline-success col-4 mx-auto" href="./reservation.html">前往預約板</a>
                                <button type="button" class="btn btn-primary col-4 mx-auto" data-toggle="modal" data-target="#evaluationModal">
                                    交易完成
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="record" role="tabpanel" aria-labelledby="record-tab">

                    <div class="row">
                        <div class="col-3 mb-3">
                            <div class="row no-gutters">
                                <span class="col-12 border rounded" align="center">
                                    <img src="https://upload.cc/i1/2019/12/11/6ylCR0.jpg" class="card-img-top col-10" alt="" style="max-height: 250px;width: auto">
                                </span>
                            </div>
                        </div>
                        <div class="col-5 mb-3">
                            <div class="row no-gutters">
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">品名：</div>床墊
                                            </td>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易數量：</div>1
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易總額：</div>850
                                            </td>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">買家：</div>阿蔡
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">賣家評級：</div>★★★★✩
                                            </td>
                                            <td>
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">商品評級：</div>★★★★★
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">商品評價：</div>很乾淨、好躺
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="browse" role="tabpanel" aria-labelledby="browse-tab">
                    <div class="card mb-3">
                        <div class="row no-gutters">
                            <div class="col-4">
                                <img src="http://s2.mycomic.cc/uploads/f4/d/450076/15135831021858.jpg" class="card-img-top" alt="">
                            </div>
                            <div class="card-body col-8">
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-title">衛生紙</h5>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="card col-5">
                                        <div class="card-body">
                                            <p class="card-text">
                                                底價
                                            </p>
                                        </div>
                                    </div>
                                    <div class="card col-5">
                                        <div class="card-body">
                                            <p class="card-text">
                                                競標價
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="card col-4">
                                        <div class="card-body">
                                            <p class="card-text">
                                                單位競標價
                                            </p>
                                        </div>
                                    </div>
                                    <div class="card col-7">
                                        <div class="card-body">
                                            <p class="card-text">
                                                結束日期
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-body">
                                        <h5 class="card-text">直購價</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>
    <!-- Button trigger modal -->

    <!--fade-->


    <!--交易完成後評價 evaluationModal -->
    <div class="modal fade" id="evaluationModal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">本次交易評價</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <form id="formEv" class="form-group">
                        <div class="card">
                            <div class="card-body">
                                <!--<select class="col-3 custom-select" name="ID" id="tradeID1">
                                    <option value="" selected>交易序號</option>
                                </select>-->

                                <label>賣家評級:</label><br>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="MemberEv" value="1">
                                    <label class="form-check-label" for="inlineRadio1">1</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="MemberEv" value="2">
                                    <label class="form-check-label" for="inlineRadio2">2</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="MemberEv" value="3">
                                    <label class="form-check-label" for="inlineRadio3">3</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="MemberEv" value="4">
                                    <label class="form-check-label" for="inlineRadio4">4</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="MemberEv" value="5">
                                    <label class="form-check-label" for="inlineRadio5">5</label>星
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <label>商品評級:</label><br>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="ProductEv" value="1">
                                    <label class="form-check-label" for="inlineRadio1">1</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="ProductEv" value="2">
                                    <label class="form-check-label" for="inlineRadio2">2</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="ProductEv" value="3">
                                    <label class="form-check-label" for="inlineRadio3">3</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="ProductEv" value="4">
                                    <label class="form-check-label" for="inlineRadio4">4</label>星
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="ProductEv" value="5">
                                    <label class="form-check-label" for="inlineRadio5">5</label>星
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-body">
                                <label>商品評價:</label>
                                <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="EvText"></textarea>
                            </div>
                        </div>
                        <button class="btn btn-outline-success container" type="submit">送出</button>
                    </form>

                    <script>
                        //交易中
                        var completeTradeId = 0;

                        //顯示交易中物品
                        $(document).ready(function() {
                            $.ajax({
                                url: 'https://ntou-store-system.herokuapp.com/personalPage/onTrade',
                                dataType: 'json',
                                type: "POST",
                                data: document.cookie,
                                //data: { ID:6 },
                                error: function(xhr, ajaxOptions, thrownError) {
                                    alert(xhr.status + "\n" + thrownError);
                                },
                                success: function(response) {


                                    $('#tableTrade').append('<div class="row no-gutters mb-4"><div class="col no-gutters"><a class="btn btn-outline-success " href="./reservation.html">前往預約板</a>')
                                    for (var i = 0; i < response.length; i++) {
                                        console.log("tradeID:" + response[i].TradeID)
                                        /*$('#tradeID1').append(
                                            $('<option/>').attr('value', response[i].TradeID)
                                            .append(response[i].TradeID)
                                        )*/
                                        $('#tableTrade').append('<table class="table table-bordered"><tbody><tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">品名：' + response[i].ProductName + '</div></td><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易數量：</div>' + response[i].TradeAmount + '</td></tr><tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">交易總額：</div>' + response[i].TradePrice + '</td></tr>' +
                                            '<tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px">買家：</div>' + response[i].Identity + '</td></tr></tbody></table>'

                                            //交易完成 
                                            +
                                            '<button type="button" class="btn btn-outline-info mb-4" data-toggle="modal" data-target="#evaluationModal" onclick="tradeCompleteFunc(' + response[i].TradeID + ')">交易完成</button></div></div>'
                                        )
                                    }
                                }
                            });
                        });

                        $("#formEv").submit(function(e) {
                            var vTradeComple = $("#formEv").serialize() + "&ID=" + completeTradeId
                            //alert(vTradeComple)
                            $.ajax({
                                type: "POST",
                                url: 'https://ntou-store-system.herokuapp.com/personalPage/onTrade/tradeCompleted',
                                data: vTradeComple,
                                dataType: 'json',
                                success: function(response) {
                                    alert("TradeComple")
                                    javascript: location.reload()
                                },
                                error: function(xhr, ajaxOptions, thrownError) {
                                    alert("formEv error")
                                },
                            })
                        });


                        function tradeCompleteFunc(x) {
                            completeTradeId = x
                        }
                    </script>
                </div>
            </div>
        </div>
    </div>

    <script>
        //架上商品
        var editId = 1;
        $(document).ready(function() {
            $.ajax({
                url: 'https://ntou-store-system.herokuapp.com/personalPage',
                dataType: 'json',
                type: "POST",
                data: document.cookie.split("; ")[0],
                // data: { ID:6 },
                error: function(xhr, ajaxOptions, thrownError) {
                    //alert(xhr.status + "\n" + thrownError);
                },
                success: function(response) {
                    //alert(response[0].length)
                    //for (var i = 19; i < 20; i++) {
                    var v1Low, v2Bid, v3BidU, v4BidD, v5Inf = ""
                    if (response[0][0].ProductName) {
                        for (var i = 0; i < response[0].length; i++) {
                            // console.log(response[0][i].ProductID)
                            v1Low = response[0][i].LowestPrice
                            v2Bid = response[0][i].BiddingPrice
                            v3BidU = response[0][i].BiddingUnitPrice
                            v4BidD = response[0][i].BiddingDeadLine
                            v5Inf = response[0][i].Information
                            //console.log(v1Low+v2Bid+v3BidU+v4BidD+v5Inf)
                            if (v1Low == null)
                                v1Low = "X"
                            if (v2Bid == null)
                                v2Bid = "X"
                            if (v3BidU == null)
                                v3BidU = "X"
                            if (v4BidD == null)
                                v4BidD = "X"
                            if (v5Inf == null)
                                v5Inf = "暫無"
                            $('#tableOnsale').append('<table class="table table-bordered" ><tbody><tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px ">品名：' + response[0][i].ProductName + '</div></td></tr>' + '<tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px" id="Price">直購價：' + response[0][i].Price + '</div></td></tr>' +
                                '<tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px" id="LowestPrice">底價：' + v1Low + '</div></td><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px" id="BiddingPrice">競標價：' + v2Bid + '</div></td></tr>' +
                                '<tr><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px" id="BiddingUnitPrice">競標單位價：' + v3BidU + '</div></td><td><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px" id="BiddingDeadLine">結標時間：' + v4BidD + '</div></td></tr>' +
                                '<tr><td colspan="2"><div class="text-secondary " style="display:inline ;LINE-HEIGHT:25px ">詳細資訊：' + v5Inf + '</div></td></tr></tbody></table>'

                                //+ `<button type="button" class="btn btn-outline-success mb-4" >try</button></div></div>`

                                //+`<button type="button" class="btn btn-outline-success mb-4" onclick="${myFunction("24","try1")}">try</button></div></div>`

                                //編輯 
                                +
                                '<button onclick="editIdFunc(' + response[0][i].ProductID + ')" type="button" class="btn btn-outline-success mb-4" data-toggle="modal" data-target="#editInfoModal">編輯詳細資訊</button></div></div>' +
                                '<button type="button" class="btn btn-outline-danger ml-3 mb-4" data-toggle="modal" onclick="deleteFunc(' + response[0][i].ProductID + ')">刪除</button></div></div>'
                            )
                        }
                    } else {
                        $('#tableOnsale').append('<div>無架上商品</div>')

                    }
                }
            });

        });

        //編輯 //done
        $("#formEdit").submit(function(e) {
            var vEdit = $("#formEdit").serialize() + "&ID=" + editId
            //alert($("#formEdit").serialize())
            //alert("vEdit=" + vEdit)
            $.ajax({
                type: $(this).attr("method"),
                url: $(this).attr("action"),
                data: vEdit,
                dataType: "json",
                success: function(response) {
                    //console.log("formEdit success")
                    if (response.state == true) {
                        window.location.href = "./personal.html";
                    } else {
                        alert("edit response false");
                    }
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    alert("ederror")
                },
            })
            e.preventDefault(); //停止預設動作
            //e.unbind(); //解除綁定。停止多個表單提交.
        });

        function editIdFunc(i) {
            console.log("x=" + i)
            editId = i
        }

        function deleteFunc(x) {
            //console.log("deleteFunction")
            $.ajax({
                url: 'https://ntou-store-system.herokuapp.com/personalPage/onSale/delete',
                dataType: 'json',
                type: "POST",
                data: {
                    ID: x,
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    alert(xhr.status + "123\n" + thrownError);
                },
                success: function(response) {
                    javascript: location.reload()
                }
            })
        }
    </script>
    <script>
        function abc() {
            console.log("abc")
        }
    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
</body></html>
